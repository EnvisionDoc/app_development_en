# Getting started with EnOS Java SDKs

EnOS provides Java SDKs to support offline application development. The Java SDKs assembles API request URL, generates signature, parses response, and optimizes application performance.

This learning module aims to help you learn how to prepare the development environment and use the Java SDK to call EnOS APIs through the example of EnOS API SDK.

## Before you start

Ensure you have resources on EnOS that you are authorized to access. The resources can be devices, data, events, user accounts, and so on. So before you start using EnOS APIs, you typically have finished connecting your devices and data into EnOS, and have a user account that has proper access policies assigned through EnOS IAM function.

To use EnOS API SDK, a service account (`accessKey` and `secretKey`) is required. The service account is generated by registering an application in the EnOS Console.

## Preparing the development environment

1. Install Java JDK SE 8.
2. Install **_Maven 3_**.
3. Obtain the SDK to use.
  You can obtain the EnOS API SDK through the following methods:
  * Include the project as a dependency in your Maven project.
  * Download the source code by cloning the GitHub repository and build on your machine.

### From Maven (as a dependency)

  _This is the recommended method of including the EnOS SDKs in your project._

1. Navigate to http://search.maven.org, search for **com.envisioniot.enos** and take note of the latest version number (or the version number of whichever version of the sdk you want to use).
2. In your main `pom.xml` file, add the EnOS API SDK as a dependency as follows:
  ```java
  	<dependency>
      <groupId>com.envisioniot</groupId>
      <artifactId>enos-api-sdk</artifactId>
      <version>0.0.2</version>
      <!--You might need to change the version number as you need.-->
      </dependency>
  ```

### Build SDK from source code and import into IDE

1. Get a copy of the **EnOS API SDK for Java** from the master branch of the GitHub repository: https://github.com/EnvisionIot/enos-api-java-sdk
  ```
  git clone https://github.com/EnvisionIot/enos-api-java-sdk.git
  ```
2. After you have obtained a copy of the source, you can build the SDK for Java.

3. Import the JAR package into your integrated development envionrment.

    - For Eclipse, take the following steps:

      1. Download the *enos-api-v2-x.x.x.jar* file and copy it to your project folder.
      2. Open your project in Eclipse, right-click the project, and select **Properties**.
      3. In the pop-up window, select **Java Build Path** > **Libraries** > **Add JARs** to import the downloaded JAR file.
      4. Click **Apply**.

    - For IntelliJ, take the following steps:

      1. Download the *enos-api-v2-x.x.x.jar* file and copy it to your project folder.
      2. Open your project in IntelliJ, and select **File** > **Project Structure** from the menu bar.
      3. Click **Apply** > **OK**.

## Using EnOS API SDK
Take the following major steps to use EnOS API SDK to call an API.

1. Retrieve service account and secret, `EnOSDefaultClient`.

   ```
   String serverUrl = "xxx";
   String accessKey = "xxx";
   String secretKey = "xxx";
   int connectTimeout = 5000; //Set connect timeout as 5000 milliseconds
   int readTimeout = 5000;    //Set read timeout as 5000 milliseconds
   EnOSDefaultClient client = new EnOSDefaultClient(serverUrl, accessKey,secretKey,connectTimeout,readTimeout);
   ```

2. Build and execute the request. Take `getPolicy` API as an example:

   ```
   GetPolicyRequest request = new GetPolicyRequest(policyId, orgId);
   EnOSResponse<Policy> response = client.execute(request);
   ```

3. When executing the request, the SDK will generate the signature using the request parameters, include the signature in the request URL as well, and send the request to the API server. After the request is processed, parses the response by calling `response.getXXX()`.

   ```
   String status = response.getStatus()
   ```

**Code sample**
The following sample code is for creating a product.
```java
import com.envisioniot.enos.enosapi.api.request.connectservice.CreateProductRequest;
import com.envisioniot.enos.enosapi.api.resource.connectservice.Product;
import com.envisioniot.enos.enosapi.common.exception.EnOSApiException;
import com.envisioniot.enos.enosapi.common.response.EnOSResponse;
import com.envisioniot.enos.enosapi.sdk.client.EnOSDefaultClient;

public class Main {
    public static void main(String[] args) {
    String serverUrl = "xxx";
    String accessKey = "xxx";
    String secretKey = "xxx";
    int connectTimeout = 5000;
    int readTimeout = 5000;
    product.setProductName("XXX");
    product.setProductDesc("XXX");
    product.setModelId("XXXXX");
    product.setDataType(1);
    product.setNodeType(1);
    EnOSDefaultClient client = new EnOSDefaultClient(serverUrl, accessKey,secretKey,connectTimeout,readTimeout);
    Product product = new Product();
    CreateProductRequest request = new CreateProductRequest(orgId, product);
    try {
        EnOSResponse response = client.defaultClient().execute(request);
    } catch (EnOSApiException e) {
        e.printStackTrace();
    }
 }
    }
```
